遥かに仰ぎ、麗しの
劣化移植なコンバータ for Onscripter　	　            20080405a
－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
ゲームデータはソフト会社様の著作物です
自己責任でご利用ください
－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
#このスクリプトについて

『遥かに仰ぎ、麗しの』(c)will/pulltop様のシナリオソースをコンバートし、
ONScripter用に劣化移植する、のを手助けするPerlスクリプトです。
エフェクト・システム面などの再現は完全ではありません
その他不具合も多々あると思います。
問題発生時は適宜シナリオスクリプトを修正して頂けると助かります。
配布・改変等ご自由にどうぞ。
各ツールの作者様とそして勿論メーカー様に感謝します。

#動作環境　(使用したver)

 ◇Perl　(ActivePerl 5.8.8 Build819) jcode.pl不要	
 ◇ONScripter　ogapee様（ONScripter-20080110 for PSP/Win　すとーむ様製)
　　　　　　　　　　　　　http://blog.livedoor.jp/tormtorm/	
 が動作するPCその他
 Nscripterでの動作は保証しておりません

#データ抽出・変換・配置
ONScripterフォルダ構成
/image
/voice (以上アーカイブ化推奨)
/se
/bgm
-0.txt
-1.txt
-default.ttf
-ONS本体

#データ抽出

　◇Will系列用の抽出ツールやsusieプラグインとそれらを扱えるツール。色々あるので略

を利用して抽出できます。作者さまに感謝いたします。

-画像 
chip.arc chip[X].arc　=> /image

アーカイブファイルよりファイルを展開、同時にPNGなどリサイズツールで読める形式へ変換してください。
デフォルトではPNGで使用します。他の形式を使う場合は適宜書き換えてください。
なお、使用する画像ファイルは"wip"ファイルと"msk"ファイルのみ。それぞれ別のフォルダへ展開します
"mos""anm""tbl"などは使いません。

FastStoneIVなどでリサイズして /wip  /mask のように別のフォルダの直下に配置
chip などのディレクトリ（アーカイブファイル）構造は無視して構いません。

※ 一部以外のマスク画像はネガ反転する必要があります。FastStoneIV なら
[advanced option]→[use adjustments]→[negative]　と設定。

※※　エフェクト用のマスク画像 "EFMASK_xx"だけは反転せずにそのまま使います。

※※※　名前表示のベースとなる画像(nmbase)は下の部分を削除すると見栄えがよくなります。

/wip
├aaa.png　(wip)
├bbb.png

/mask
├aaa.png  (msk ネガ反転）
├bbb.png
├efmask.png (msk 非ネガ反転)

となったら、同名のファイルを結合して /image フォルダへ。

/wip/aaa.png + /mask/aaa.png

※一方にしかないファイルはそのまま /image フォルダへコピー。

結合にはコマンドラインで使えるパノラマ化ツールなどが便利だと思います。
例によって　PerlMagick 用のスクリプトは用意しましたが…。
wip_msk.pl （結合もしくはそのままコピーします）

Nスクの解像度は 800x600 を想定しています。
お使いの環境に応じてリサイズして下さい。

-音声等
voice.arc => /voice
se.arc    => /se
bgm.arc   => /bgm

に解凍。ファイル構成が違う場合は適宜調整願います。

※PSPの場合はステレオ(2ch)にするとフリーズしにくくなります。
また、アーカイブに入れるのは /voice だけにとどめた方が良いと思います。
更に大容量のSEファイルを削除すればメモリ不足によるフリーズは大分解消される、かも 
　
#シナリオ変換
rio.arc  => /rio
rio.arc を /rio フォルダに展開します。
/rio フォルダの上に同梱のファイルを解凍して下さい。

/hogehoge（任意のフォルダ）
├kani.pl
├nsc.pl
├make0.pl
├base0.txt
├/rio
  ├example.wsc
  ～

コマンドラインなどから kani.pl nsc.pl make0.pl の順で実行して下さい。
0.txt 1.txt が作成されます

※まとめようかとも思いましたが、工程を分けた方が処理がしやすいのでこうなりました。
煩雑でごめんなさい

※1.txt のサイズがかなり大きいため、メモリの少ない環境ではフリーズしやすくなります。
本校系 HO MY SI TO
分校系 BU MS SU YU
なので、それぞれ逆のものを /rio_out から取り除いて nsc.pl を実行してみてください
両方とも4M前後に落ち着くため、フリーズ頻度はかなり減るかと思います。


*既知の問題点
  回想・CG・サウンドモード・ムービー未実装。いつかいれるかも？（そればっかりだ
　コンフィグモードは予定もございません
　色々なエフェクトが再現出来ていません。
　タイトル画面が手抜きです。　※エピローグはちょっと待って…→やっぱり手抜きですが実装しました
　立ち絵移動やbgmフェードインなどは今後実装予定。クロスフェードは㍉ぽ
　あとその他細かい不具合がぽろぽろ出てくる予定
  その他のWill系列ソフトにも使えるか検証したいと思います

更新点

20080405 拡張スプライト対応。スクリプトサイズ削減。ONS20080110以降のバージョンで動作します。
	 a)シナリオフラグとシステムフラグが衝突してました。出ていなかった効果音など修正。

20071122 バックログ強化。世界で一番NGな恋（体験版）暫定対応。

20070715 シナリオサイズ削減。タイトルメニュー（エピローグ含む）を手抜きで実装 a:分校系フラグ処理修正

20070630 スプライト移動を実装。

20070624 暫定公開 a:ボイス、効果音まわりをほんの少しだけ調整

written by ひとつもり
http://hitotsumori.com/pspdeons/